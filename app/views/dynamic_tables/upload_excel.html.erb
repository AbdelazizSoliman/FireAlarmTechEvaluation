<!-- app/views/dynamic_tables/upload_excel.html.erb -->
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <%= csrf_meta_tags %>
    <%= csp_meta_tag %>
    <title>Import Tables from Excel</title>
    <%= stylesheet_link_tag "application", "data-turbo-track": "reload" %>
  </head>
  <body class="bg-gray-50 min-h-screen p-8">
    <div class="max-w-3xl mx-auto">
      <h1 class="text-2xl font-bold mb-6">Import Tables from Excel</h1>

      <% if flash[:error] %>
        <div class="mb-4 p-3 bg-red-100 text-red-800"><%= flash[:error] %></div>
      <% end %>

      <% if flash[:notice] %>
        <div class="mb-4 p-3 bg-yellow-100 text-yellow-800">
          <%= flash[:notice] %>
        </div>
      <% end %>

      <%= form_with url: admin_preview_excel_path, method: :post, multipart: true, data: { turbo: false }, class: "space-y-4" do |form| %>
        <%= form.hidden_field :authenticity_token, value: form_authenticity_token %>
        <%= form.hidden_field :subsystem_id, value: @subsystem_id %>

        <div>
          <label class="block font-medium">Select an Excel file:</label>
          <%= form.file_field :excel_file, accept: ".xlsx", required: true, class: "mt-1 block w-full border-gray-300 rounded" %>
        </div>

        <%= form.submit "Import Tables", class: "px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700" %>
      <% end %>
    </div>
  </body>
</html>
