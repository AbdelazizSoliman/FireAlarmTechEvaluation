<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Subsystem Evaluation Report</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 20px;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-bottom: 20px;
    }
    table, th, td {
      border: 1px solid black;
    }
    th, td {
      padding: 8px;
      text-align: left;
    }
  </style>
</head>
<body>
  <h1>Subsystem Evaluation Report</h1>
  <p><strong>Notification:</strong> <%= @notification.title %></p>
  <p><strong>Submitted By:</strong> <%= @notification.body %></p>

  <h2>Supplier Data</h2>
  <ul>
    <% @supplier_data.attributes.each do |key, value| %>
      <li><strong><%= key.humanize %>:</strong> <%= value %></li>
    <% end %>
  </ul>

  <h2>Product Data</h2>
  <ul>
    <% @product_data.attributes.each do |key, value| %>
      <li><strong><%= key.humanize %>:</strong> <%= value %></li>
    <% end %>
  </ul>

  <h2>Fire Alarm Control Panel</h2>
  <table>
    <thead>
      <tr>
        <th>Attribute</th>
        <th>Value</th>
      </tr>
    </thead>
    <tbody>
      <% @fire_alarm_control_panel.attributes.each do |key, value| %>
        <tr>
          <td><%= key.humanize %></td>
          <td><%= value %></td>
        </tr>
      <% end %>
    </tbody>
  </table>

  <h2>Graphic Systems</h2>
  <ul>
    <% @graphic_system.attributes.each do |key, value| %>
      <li><strong><%= key.humanize %>:</strong> <%= value %></li>
    <% end %>
  </ul>

  <h2>Detectors Field Devices</h2>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Value</th>
        <th>Unit Rate</th>
        <th>Amount</th>
        <th>Notes</th>
      </tr>
    </thead>
    <tbody>
      <% @detectors_field_device.attributes.each do |key, value| %>
        <% if key.ends_with?('_value') %>
          <tr>
            <td><%= key.sub('_value', '').humanize %></td>
            <td><%= value %></td>
            <td><%= @detectors_field_device["#{key.sub('_value', '_unit_rate')}"] %></td>
            <td><%= @detectors_field_device["#{key.sub('_value', '_amount')}"] %></td>
            <td><%= @detectors_field_device["#{key.sub('_value', '_notes')}"] %></td>
          </tr>
        <% end %>
      <% end %>
    </tbody>
  </table>

  <!-- Manual Pull Station -->
  <% if @manual_pull_station.present? %>
    <h2>Manual Pull Station</h2>
    <ul>
      <% @manual_pull_station.attributes.each do |key, value| %>
        <li><strong><%= key.humanize %>:</strong> <%= value %></li>
      <% end %>
    </ul>
  <% else %>
    <p>No Manual Pull Station data available.</p>
  <% end %>

  <!-- Door Holders -->
  <% if @door_holder.present? %>
    <h2>Door Holders</h2>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Value</th>
          <th>Unit Rate</th>
          <th>Amount</th>
          <th>Notes</th>
        </tr>
      </thead>
      <tbody>
        <% # Just like your existing logic in the Excel template %>
        <%[
          { type: 'total_no_of_devices', label: 'Total Number of Devices' },
          { type: 'total_no_of_relays', label: 'Total Number of Relays' }
        ].each do |attribute| %>
          <% type_key = attribute[:type] %>
          <tr>
            <td><%= attribute[:label] %></td>
            <td><%= @door_holder[type_key] %></td>
            <td><%= @door_holder["#{type_key}_unit_rate"] %></td>
            <td><%= @door_holder["#{type_key}_amount"] %></td>
            <td><%= @door_holder["#{type_key}_notes"] %></td>
          </tr>
        <% end %>
      </tbody>
    </table>
  <% else %>
    <p>No Door Holders data available.</p>
  <% end %>

  <!-- Notification Devices -->
  <% if @notification_devices.present? %>
    <h2>Notification Devices</h2>
    <ul>
      <% @notification_devices.attributes.each do |key, value| %>
        <li><strong><%= key.humanize %>:</strong> <%= value %></li>
      <% end %>
    </ul>
  <% else %>
    <p>No Notification Devices data available.</p>
  <% end %>

</body>
</html>
