<div class="bg-gray-100 p-6 rounded-lg shadow-md max-w-4xl mx-auto">
  <h1 class="text-3xl font-bold text-center text-gray-800 mb-6">Generate Apple-to-Apple Comparison</h1>

  <%= form_with url: apple_to_apple_comparison_reports_path, method: :get, local: true, class: "space-y-6" do |f| %>
    <!-- Subsystem Filter -->
    <div class="flex items-center space-x-4">
      <div>
        <%= f.label :subsystem_id, "Select Subsystem:", class: "block font-semibold" %>
        <%= f.select :subsystem_id,
                     options_from_collection_for_select(@subsystems, :id, :name, params[:subsystem_id]),
                     { include_blank: "All Subsystems" },
                     class: "border rounded px-3 py-2" %>
      </div>
      <div>
        <%= f.submit "Filter Suppliers", class: "bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700" %>
      </div>
    </div>

    <% if @suppliers_with_subsystems.any? %>
      <!-- Supplier Selection Table -->
      <table class="min-w-full bg-white rounded-lg shadow-md overflow-hidden">
        <thead class="bg-gray-200">
          <tr>
            <th class="px-6 py-3 text-left text-sm font-semibold text-gray-700">Select</th>
            <th class="px-6 py-3 text-left text-sm font-semibold text-gray-700">Supplier Name</th>
          </tr>
        </thead>
        <tbody class="text-gray-700">
          <% @suppliers_with_subsystems.each do |supplier| %>
            <tr class="border-t">
              <td class="px-6 py-3">
                <%= check_box_tag 'selected_suppliers[]', supplier.id,
                     Array(params[:selected_suppliers]).include?(supplier.id.to_s),
                     class: "form-checkbox"
                %>
              </td>
              <td class="px-6 py-3 font-medium"><%= supplier.supplier_name %></td>
            </tr>
          <% end %>
        </tbody>
      </table>

      <!-- Action Buttons -->
      <div class="flex space-x-4">
        <%= f.submit "Show Comparison",
                     name: 'commit',
                     value: 'show',
                     class: "bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700" %>

        <%= f.submit "Generate Comparison",
                     name: 'commit',
                     value: 'generate',
                     class: "bg-red-600 text-white px-4 py-2 rounded hover:bg-red-700" %>
      </div>
    <% else %>
      <p class="text-center text-gray-500">No suppliers found for the selected subsystem.</p>
    <% end %>
  <% end %>
</div>
